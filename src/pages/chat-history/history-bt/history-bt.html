<div class="bg-theme w-100 button-hover px-2 py-1 px-sm-0 py-sm-0">
  <div
          (click)="changeSession(history?.dataId,$event)"
          [class.border-1]="selectId===history?.dataId"
          [class.selected]="selectId===history?.dataId"
          class="border-box w-100 p-2 rounded-3 mini bg-theme d-flex justify-content-between text-theme text-start position-relative">

<!--    <div class="overflow-hidden-x ">{{ history?.title }}</div>-->
<!--    @if(selectId===history?.dataId){-->
<!--      <span-->
<!--        nz-icon class="mx-2 py-1"-->
<!--        #spanBt-->
<!--        nz-dropdown nzTrigger="click" [nzDropdownMenu]="menu"-->
<!--        nzType="dash" nzTheme="outline"></span>-->
<!--    }-->

<!--    <nz-dropdown-menu #menu="nzDropdownMenu">-->
<!--      <div class="d-flex flex-column" >-->
<!--        <button class="text-start" (click)="deleteAction()" nz-button><span nz-icon class="" nzType="delete" nzTheme="outline"></span>{{ 'chat-history.delete' | translate}}</button>-->
<!--      </div>-->
<!--    </nz-dropdown-menu>-->
    <div class="d-flex align-items-center w-100 overflow-hidden">
      <!-- 修改2：标题添加截断样式 -->
      <div class="text-truncate pe-2 flex-grow-1 min-w-0">
        {{ history?.title }}
      </div>

      <!-- 修改3：图标始终显示（但通过透明度控制视觉隐藏） -->
      @if(selectId===history?.dataId){
      <span
        nz-icon
        class="flex-shrink-0 opacity-100"
        #spanBt
        nz-dropdown
        nzTrigger="click"
        [nzDropdownMenu]="menu"
        nzType="dash"
        nzTheme="outline"></span>
      }
      <!-- 修改4：添加占位元素保持布局稳定 -->
      @if(selectId!==history?.dataId){
        <span class="flex-shrink-0 invisible" style="width: 24px"></span>
      }

    </div>

    <nz-dropdown-menu #menu="nzDropdownMenu">
      <div class="d-flex flex-column">
        <button (click)="deleteAction()" class="text-start" nz-button>
          <span nz-icon nzTheme="outline" nzType="delete"></span>
          {{ 'chat-history.delete' | translate}}
        </button>
      </div>
    </nz-dropdown-menu>
  </div>
</div>
